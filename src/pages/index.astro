---
export const prerender = false
import Layout from '../layouts/Layout.astro';
import axios, { type AxiosResponse } from "axios";
import { aResult, type Result } from "@volpe/utils";
import {type Course} from "../env.d"
import Card from "../components/Card/Card.astro";

const currentTime = new Date().toLocaleTimeString();
Astro.response.headers.set('Cache-Control', 'public, maxage=20, s-maxage=30, stale-while-revalidate=15');

const api_qa = axios.create({
  baseURL: "https://qa.api.somosedison.com",
  headers: {
    Authorization: "l33hDPtjJK0emSag5NcJKdrJbWXUFpORTSih",
  },
});

const [err, axiosResponse] = await api_qa.get[aResult](`/courses/market/2a748937-dfff-419c-908e-fa16856e19fe`) as Result<AxiosResponse<Course[]>>;

// const [err, axiosResponse] = await api_qa.get[aResult](`/courses/market/ffde42cb-1588-4928-8dd6-330b02ff26df`) as Result<AxiosResponse<Course[]>>;


if (err) throw err
if (!axiosResponse) throw err

const {data: courses} = axiosResponse

---

<Layout>
  hola<br/>
  {currentTime}
  <br/>
  <h1>Im√°genes Optimizadas</h1>
  <div class="grid gap-4">
    {courses.map(course => <Card course={course} />)}
  </div>
</Layout>

<style>
  div {
    grid-template-columns: repeat(auto-fill, minmax(min(270px, 450px), 1fr));
  }
</style>
